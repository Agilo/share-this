!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ShareThis=t()}(this,(function(){"use strict";var e;function t(t,n){return e||(e=function(e){for(var t="atchesSelector",n=0,r=["matches","m"+t,"webkitM"+t,"mozM"+t,"msM"+t,"oM"+t];n<r.length;n++){var o=r[n];if(e[o])return o}}(t)),t[e](n)}function n(e,n){for(var r=e;r&&(1!==r.nodeType||!t(r,n));)r=r.parentNode;return r}function r(e,t){if(t&&"object"==typeof t)for(var n in t)e[n]=t[n];return e}function o(e){return"function"==typeof e}function i(e,t){var r=e.cloneRange();if(e.collapsed||!t)return r;var o=n(e.startContainer,t);return o?function(e,t){var n=e.compareDocumentPosition(t);return!n||(16&n)>0}(o,e.endContainer)||r.setEnd(o,o.childNodes.length):(o=n(e.endContainer,t))?r.setStart(o,0):r.collapse(),r}function a(e,t,n){var r=n.document,o=r.defaultView,i=function(e){if(e.isCollapsed)return!0;var t=e.anchorNode.compareDocumentPosition(e.focusNode);return t?(4&t)>0:e.anchorOffset<e.focusOffset}(o.getSelection()),a=function(e,t){var n,r=e.getClientRects(),o=[].slice.bind(r);if(t){for(var i=1/0,a=r.length;a--;){var c=r[a];if(c.left>i)break;i=c.left}n=o(a+1)}else{for(var u=-1/0,f=0;f<r.length;f++){var s=r[f];if(s.right<u)break;u=s.right}n=o(0,f)}return{top:Math.min.apply(Math,n.map((function(e){return e.top}))),bottom:Math.max.apply(Math,n.map((function(e){return e.bottom}))),left:n[0].left,right:n[n.length-1].right}}(t,i),c=function(e){var t=e.document.body;return("static"===e.getComputedStyle(t).position?t.parentNode:t).getBoundingClientRect()}(o),u=e.style;i?u.right=r.documentElement.clientWidth-a.right+c.left+"px":u.left=a.left-c.left+"px",u.width=a.right-a.left+"px",u.height=a.bottom-a.top+"px",u.top=a.top-c.top+"px",u.position="absolute",e.className=n.popoverClass}var c="data-share-via";function u(e){return{createPopover:function(){var t=e.createElement("div");return t.addEventListener("click",(function(e){!function(e,t){var r=n(t.target,"["+c+"]");if(r){var i=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.name===t)return r}}(e,r.getAttribute(c));i&&o(i.action)&&i.action(t,r)}}(this.sharers,e)})),t},attachPopover:function(t){e.body.appendChild(t)},removePopover:function(e){var t=e.parentNode;t&&t.removeChild(e)}}}var f,s=function(e,t,n,r){var o=e.shareUrl||e.document.defaultView.location;return"<ul>"+t.map((function(e){return'<li data-share-via="'+e.name+'">'+e.render.call(e,n,r,o)+"</li>"})).join("")+"</ul>"},l=["selectionchange","mouseup","touchend","touchcancel"];return function(e){var t=(Object.assign||r)({document:document,selector:"body",sharers:[],popoverClass:"share-this-popover",transformer:function(e){return e.trim().replace(/\s+/g," ")}},e||{}),n=!1,c=!1,p=f,d=f,v=f,h=f;return{init:function(){return!n&&(p=t.document,(d=p.defaultView).getSelection?(l.forEach(m),d.addEventListener("resize",b),h=u(p),n=!0):(console.warn("share-this: Selection API isn't supported"),!1))},destroy:function(){return!(!n||c)&&(l.forEach(g),d.removeEventListener("resize",b),E(),p=f,d=f,c=!0)},reposition:function(){return v&&a(v,C(),t),!!v},drawPopover:function(e){P(i(e,t.selector))},killPopover:E};function m(e){p.addEventListener(e,y)}function g(e){p.removeEventListener(e,y)}function b(){v&&a(v,C(),t)}function y(e){var t=e.type;!v!==("selectionchange"===t)&&setTimeout((function(){if(d){var e=C();e?P(e):E()}}),10)}function C(){var e=d.getSelection(),n=e.rangeCount&&e.getRangeAt(0);if(n){var r=i(n,t.selector);if(!r.collapsed&&r.getClientRects().length)return r}}function P(e){var n=!v,r=e.toString(),i=t.transformer(r),c=t.sharers.filter(M.bind(null,i,r));c.length?(n&&(v=h.createPopover()),v.sharers=c,v.innerHTML=s(t,c,i,r),a(v,e,t),n&&(h.attachPopover(v),o(t.onOpen)&&t.onOpen(v,i,r))):v&&E()}function E(){v&&(h.removePopover(v),v=f,o(t.onClose)&&t.onClose())}function M(e,t,n){var r=n.active;return o(r)?r(e,t):r===f||r}}}));
//# sourceMappingURL=share-this.js.map
