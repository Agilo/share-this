!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ShareThis=t()}(this,function(){"use strict";function e(e){var t=e.documentElement.scrollLeft+e.body.scrollLeft,n=e.documentElement.scrollTop+e.body.scrollTop;return{left:t,top:n}}function t(e,t){return d||(d=r(e)),e[d](t)}function n(e,n){for(var o=e;o&&(1!==o.nodeType||!t(o,n));)o=o.parentNode;return o}function o(e,t){var n=e.compareDocumentPosition(t);return!n||(16&n)>0}function r(e){for(var t=["matches","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],n=0;n<t.length;n++){var o=t[n];if("function"==typeof e[o])return o}}function i(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.name===t)return o}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function c(e){if(e.collapsed||e.isCollapsed)return!0;var t=e.anchorNode.compareDocumentPosition(e.focusNode);return t?(4&t)>0:e.anchorOffset<e.focusOffset}function u(e,t){var n=void 0,o=e.getClientRects();if(t){for(var r=1/0,i=o.length;i--;){var c=o[i];if(c.left>r)break;r=c.left}n=m.call(o,i+1)}else{for(var u=-(1/0),l=0;l<o.length;l++){var f=o[l];if(f.right<u)break;u=f.right}n=m.call(o,0,l)}return{top:Math.min.apply(Math,a(n.map(function(e){return e.top}))),bottom:Math.max.apply(Math,a(n.map(function(e){return e.bottom}))),left:n[0].left,right:n[n.length-1].right}}function l(e,t){var r=e.cloneRange();if(e.collapsed||!t)return r;var i=n(e.startContainer,t);return i?o(i,e.endContainer)||r.setEnd(i,i.childNodes.length):(i=n(e.endContainer,t),i?r.setStart(i,0):r.collapse()),r}function f(t,n,o){var r=o.document,i=r.defaultView.getSelection(),a=c(i),l=u(n,a),f=e(r),s=t.style;a?s.right=r.documentElement.clientWidth-l.right-f.left+"px":s.left=f.left+l.left+"px",s.width=l.right-l.left+"px",s.top=l.top+"px",s.position="absolute",t.className=o.popoverClass}function s(e,t){var o=n(t.target,"[data-share-via]");if(o){var r=o.getAttribute("data-share-via"),a=i(e,r);a&&"function"==typeof a.action&&a.action.call(t,o)}}function p(e){return{createPopover:function(t){var n=e.createElement("div");return n.addEventListener("click",s.bind(null,t)),n},attachPopover:function(t){e.body.appendChild(t)},removePopover:function(e){var t=e.parentNode;t&&t.removeChild(e)}}}var d=void 0,v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=Object.assign||function(e,t){if(t&&"object"===("undefined"==typeof t?"undefined":v(t)))for(var n in t)e[n]=t[n];return e},m=Array.prototype.slice,y=function(e,t,n,o){var r=e.shareUrl||e.document.defaultView.location;return"<ul>"+t.map(function(e){return'<li data-share-via="'+e.name+'">'+e.render.call(e,n,o,r)+"</li>"}).join("")+"</ul>"},g=void 0,b=function(e){function t(){var e=d.rangeCount&&d.getRangeAt(0);if(!e)return void o();var t=l(e,i.selector);return t.collapsed?void o():void n(t)}function n(e){if(!v){var t=e.toString(),n=i.transformer(t);m=i.sharers.filter(r.bind(null,n,t)),m.length&&(v=b.createPopover(m),v.innerHTML=y(i,m,n,t),f(v,e,i),b.attachPopover(v),"function"==typeof i.onOpen&&i.onOpen(v,n,t))}}function o(){v&&(b.removePopover(v),v=m=null,"function"==typeof i.onClose&&i.onClose())}function r(e,t,n){return"function"==typeof n.active?n.active(e,t):n.active===g||n.active}var i=h({document:document,selector:"body",sharers:[],popoverClass:"share-this-popover",transformer:function(e){return e.trim().replace(/\s+/g," ")}},e||{}),a=!1,c=!1,u=g,s=g,d=g,v=g,m=g,b=g;return{init:function(){if(a)return!1;if(s=i.document,u=s.defaultView,!u.getSelection)return console.error("Selection API isn't supported"),!1;var e=s.addEventListener.bind(s);return e("selectionchange",o),e("mouseup",t),e("touchend",t),d=u.getSelection(),b=p(s),a=!0},destroy:function(){if(!a||c)return!1;var e=s.removeEventListener.bind(s);return e("selectionchange",o),e("mouseup",t),e("touchend",t),o(),d=u=s=null,c=!0}}};return b});